(function(){"use strict";var n=angular.module("LocalStorageModule",[]);n.provider("localStorageService",function(){this.prefix="ls";this.cookie={expiry:30,path:"/"};this.notify={setItem:!0,removeItem:!1};this.setPrefix=function(n){this.prefix=n};this.setStorageCookie=function(n,t){this.cookie={expiry:n,path:t}};this.setNotify=function(n,t){this.notify={setItem:n,removeItem:t}};this.$get=["$rootScope","$window","$document",function(n,t,i){var r=this.prefix,s=this.cookie,e=this.notify;r.substr(-1)!=="."&&(r=!r?"":r+".");var u=function(){try{var u="localStorage"in t&&t.localStorage!==null,i=r+"__"+Math.round(Math.random()*1e7);return u&&(localStorage.setItem(i,""),localStorage.removeItem(i)),!0}catch(f){return n.$broadcast("LocalStorageModule.notification.error",f.message),!1}}(),c=function(t,i){if(!u)return n.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),e.setItem&&n.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:i,storageType:"cookie"}),f(t,i);typeof i=="undefined"&&(i=null);try{(angular.isObject(i)||angular.isArray(i))&&(i=angular.toJson(i));localStorage.setItem(r+t,i);e.setItem&&n.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:i,storageType:"localStorage"})}catch(o){return n.$broadcast("LocalStorageModule.notification.error",o.message),f(t,i)}return!0},y=function(t){if(!u)return n.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),v(t);var i=localStorage.getItem(r+t);return!i||i==="null"?null:i.charAt(0)==="{"||i.charAt(0)==="["?angular.fromJson(i):i},l=function(t){if(!u)return n.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),e.removeItem&&n.$broadcast("LocalStorageModule.notification.removeitem",{key:t,storageType:"cookie"}),o(t);try{localStorage.removeItem(r+t);e.removeItem&&n.$broadcast("LocalStorageModule.notification.removeitem",{key:t,storageType:"localStorage"})}catch(i){return n.$broadcast("LocalStorageModule.notification.error",i.message),o(t)}return!0},p=function(){var t,i,f;if(!u)return n.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;t=r.length;i=[];for(f in localStorage)if(f.substr(0,t)===r)try{i.push(f.substr(t))}catch(e){return n.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return i},w=function(t){var t=t||"",e=r.slice(0,-1)+".",o=RegExp(e+t),f,i;if(!u)return n.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),h();f=r.length;for(i in localStorage)if(o.test(i))try{l(i.substr(f))}catch(s){return n.$broadcast("LocalStorageModule.notification.error",s.message),h()}return!0},a=function(){try{return navigator.cookieEnabled||"cookie"in i&&(i.cookie.length>0||(i.cookie="test").indexOf.call(i.cookie,"test")>-1)}catch(t){return n.$broadcast("LocalStorageModule.notification.error",t.message),!1}},f=function(t,u){if(typeof u=="undefined")return!1;if(!a())return n.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var e="",f=new Date;u===null?(f.setTime(f.getTime()+-864e5),e="; expires="+f.toGMTString(),u=""):s.expiry!==0&&(f.setTime(f.getTime()+s.expiry*864e5),e="; expires="+f.toGMTString());!t||(i.cookie=r+t+"="+encodeURIComponent(u)+e+"; path="+s.path)}catch(o){return n.$broadcast("LocalStorageModule.notification.error",o.message),!1}return!0},v=function(t){var e,f,u;if(!a())return n.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(e=i.cookie.split(";"),f=0;f<e.length;f++){for(u=e[f];u.charAt(0)===" ";)u=u.substring(1,u.length);if(u.indexOf(r+t+"=")===0)return decodeURIComponent(u.substring(r.length+t.length+1,u.length))}return null},o=function(n){f(n,null)},h=function(){for(var f,n=null,e=r.length,u=i.cookie.split(";"),t=0;t<u.length;t++){for(n=u[t];n.charAt(0)===" ";)n=n.substring(1,n.length);f=n.substring(e,n.indexOf("="));o(f)}};return{isSupported:u,set:c,add:c,get:y,keys:p,remove:l,clearAll:w,cookie:{set:f,add:f,get:v,remove:o,clearAll:h}}}]})}).call(this);
/*
//# sourceMappingURL=angular-local-storage.min.js.map
*/